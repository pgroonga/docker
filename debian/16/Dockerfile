FROM postgres:16-bookworm

ENV PGROONGA_VERSION=3.1.5-1
ENV POSTGRESQL_VERSION=16
RUN \
  apt update && \
  apt install -y -V wget && \
  wget https://apache.jfrog.io/artifactory/arrow/debian/apache-arrow-apt-source-latest-bookworm.deb && \
  apt install -y -V ./apache-arrow-apt-source-latest-bookworm.deb && \
  rm apache-arrow-apt-source-latest-bookworm.deb && \
  wget https://packages.groonga.org/debian/groonga-apt-source-latest-bookworm.deb && \
  apt install -y -V ./groonga-apt-source-latest-bookworm.deb && \
  rm groonga-apt-source-latest-bookworm.deb && \
  apt update && \
  apt install -y -V \
    postgresql-${POSTGRESQL_VERSION}-pgdg-pgroonga=${PGROONGA_VERSION} \
    groonga-normalizer-mysql \
    groonga-token-filter-stem \
    groonga-tokenizer-mecab && \
  apt clean && \
  rm -rf /var/lib/apt/lists/*
